<div class='content'>
  <h1 class='title has-text-primary has-text-centered'>Assign Costume Form</h1>
</div>
<%= form_for current_user, url: assign_path, method: :post do |f| %>
  <!-- existing costume -->
  <div class='box'>
    <div class='field'>
      <%= f.label 'Select A Costume', class: 'subtitle' %>
      <div class='control'>
        <%= f.collection_radio_buttons :costume_ids, current_user.costumes, :id, :picture do |b| %>
          <% if !b.object.picture.blank? %>
            <%= b.label(class: 'radio') { b.radio_button + image_tag(b.object.picture, width: 75) } %>
          <% elsif !b.object.onepiece_description.blank? %>
            <%= b.label(class: 'radio') { b.radio_button + b.object.onepiece_description } %>
          <% else %>
            <%= b.label(class: 'radio') { b.radio_button + b.object.twopiece_description } %>
          <% end %>
        <% end %>
      </div>
    </div>
  </div>
  <!-- create a new costume -->
  <div class='box'>
    <div class='field'>
      <%= f.label 'Or Create A New Costume', class: 'subtitle' %>
      <div class='control'>
        <%= f.fields_for :costume, current_user.costumes.build do |costume_fields| %>
          <!-- top description -->
          <div class='box'>
            <h2 class='subtitle'>Two-Piece Costume</h2>
            <div class='field'>
              <%= costume_fields.label :top_description, class: 'label' %>
              <div class='control has-icons-left'>
                <%= costume_fields.text_field :top_description, class:'input', placeholder: 'Enter description of top for a two-piece costume' %>
              </div>
            </div>
            <!-- bottoms description -->
            <div class='field'>
              <%= costume_fields.label :bottoms_description, class: 'label' %>
              <div class='control has-icons-left'>
                <%= costume_fields.text_field :bottoms_description, class:'input', placeholder: 'Enter description of bottoms for a two-piece costume' %>
              </div>
            </div>
            <p class='help is-danger'>Must fill out both for a two-piece costume</p>
          </div>
          <!-- onepiece description -->
          <div class='box'>
            <h2 class='subtitle'>One-Piece Costume</h2>
            <div class='field'>
              <%= costume_fields.label 'Description', class: 'label' %>
              <div class='control has-icons-left'>
                <%= costume_fields.text_field :onepiece_description, class:'input', placeholder: 'Enter description for a one-piece costume' %>
              </div>
            </div>
            <p class='help is-danger'>Must fill out for a one-piece costume</p>
          </div>
          <div class='box'>
            <!-- hair accessory description -->
            <div class='field'>
              <%= costume_fields.label :hair_accessory, class: 'label' %>
              <div class='control has-icons-left'>
                <%= costume_fields.text_field :hair_accessory, class:'input', placeholder: 'Enter description if costume is has a hair accessory' %>
              </div>
            </div>
            <!-- picture -->
            <div class='field'>
              <%= costume_fields.label :picture, class: 'label' %>
              <div class='control has-icons-left'>
                <%= costume_fields.text_field :picture, class:'input', placeholder: 'Enter picture url' %>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
  <!-- costume assignments fields: dance season, song name, genre, shoes, tights -->
  <%= f.fields_for :costume_assignments, current_user.costume_assignments.build do |assignments_fields| %>
    <div class='box'>
      <p class='help is-danger'>Must fill out all fields</p>
      <h2 class='subtitle'>Dance Info</h2>
      <!-- dance_season -->
      <div class='field'>
        <%= assignments_fields.label :dance_season, class: 'label' %>
        <div class='control'>
          <%= assignments_fields.text_field :dance_season, class:'input', placeholder: 'Enter dance season year' %>
        </div>
      </div>
      <!-- song_name -->
      <div class='field'>
        <%= assignments_fields.label :song_name, class: 'label' %>
        <div class='control'>
          <%= assignments_fields.text_field :song_name, class:'input', placeholder: 'Enter song name' %>
        </div>
      </div>
      <!-- genre -->
      <div class='field'>
        <%= assignments_fields.label :genre, class: 'label' %>
        <div class='control'>
          <%= assignments_fields.text_field :genre, class:'input', placeholder: 'Enter dance genre' %>
        </div>
      </div>
      <!-- shoe -->
      <div class='field'>
        <%= assignments_fields.label 'Shoes', class: 'label' %>
        <div class='control'>
          <%= assignments_fields.text_field :shoe, class:'input', placeholder: 'Enter shoes' %>
        </div>
      </div>
      <!-- tight -->
      <div class='field'>
        <%= assignments_fields.label 'Tights', class: 'label' %>
        <div class='control'>
          <%= assignments_fields.text_field :tight, class:'input', placeholder: 'Enter tights' %>
        </div>
      </div>
    </div>
    <!-- dancer, size & condition -->
    <div class='box'>
      <h2 class='subtitle'>Dancer Info</h2>
      <table class='table is-bordered is-striped is-narrow is-hoverable is-fullwidth'>
        <thead>
          <tr>
            <th>Dancer</th>
            <th>Costume Size</th>
            <th>Costume Condition</th>
          </tr>
        </thead>
        <tbody>
          <% Dancer.current_dancers(current_user).count.times do %>
            <%= assignments_fields.fields_for :costume_assignments, current_user.costume_assignments.build do |dancers_fields| %>
              <tr>
                <td>
                  <div class="select">
                    <%= dancers_fields.collection_select(:dancer_id, Dancer.current_dancers(current_user), :id, :name, {prompt: "Select A Dancer"}, {class: 'select'}) %>
                    <!--%= f.collection_check_boxes :dancer_id, @dance_studio.dancers, :id, :name, class: 'checkbox' %-->
                  </div>
                </td>
                <td><%= dancers_fields.text_field :costume_size, class:'input' %></td>
                <td>
                  <div class="select">
                    <%= dancers_fields.select(:costume_condition, options_for_select([['New', 'New'], ['Used', 'Used']])) %>
                  </div>
                </td>
              </tr>
            <% end %>
          <% end %>
        </tbody>
      </table>
    </div>
  <% end %>
  <!-- submit button -->
  <div class='field'>
    <div class='control'>
      <%= f.submit class: 'button is-primary' %>
    </div>
  </div>
<% end %>